/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){function b(a){return a&&a.Object===Object?a:null}var c={"function":!0,object:!0},d=c[typeof exports]&&exports&&!exports.nodeType?exports:null,e=c[typeof module]&&module&&!module.nodeType?module:null,f=b(d&&e&&"object"==typeof global&&global),g=b(c[typeof self]&&self),h=b(c[typeof window]&&window),i=(e&&e.exports===d?d:null,b(c[typeof this]&&this)),j=f||h!==(i&&i.window)&&h||g||i||Function("return this")();"function"==typeof define&&define.amd?define(["./rx.lite"],function(b,c){return a(j,c,b)}):"object"==typeof module&&module&&module.exports===d?module.exports=a(j,module.exports,require("rx-lite")):j.Rx=a(j,{},j.Rx)}).call(this,function(a,b,c,d){function e(a){return function(){try{return a.apply(this,arguments)}catch(b){return x.e=b,x}}}function f(a){return a.toArray()}function f(a){return a.toArray()}var g=c.internals.inherits,h=c.internals.AbstractObserver,i=c.Observable,j=i.prototype,k=c.AnonymousObservable,l=c.ObservableBase,m=(i.defer,i.empty,i.never,i["throw"],i.fromArray,c.Scheduler["default"]),n=c.SingleAssignmentDisposable,o=c.SerialDisposable,p=c.CompositeDisposable,q=c.BinaryDisposable,r=c.RefCountDisposable,s=c.Subject,t=c.internals.addRef,u=(c.Scheduler.normalize,c.helpers),v=(u.isPromise,u.isFunction),w=c.Scheduler.isScheduler,x=(i.fromPromise,{e:{}}),y=c.internals.tryCatch=function(a){if(!v(a))throw new TypeError("fn must be a function");return e(a)};j.windowWithTime=function(a,b,c){var d,e=this;return null==b&&(d=a),w(c)||(c=m),"number"==typeof b?d=b:w(b)&&(d=a,c=b),new k(function(b){function f(){var a=new n,e=!1,g=!1;l.setDisposable(a),j===i?(e=!0,g=!0):i>j?e=!0:g=!0;var o=e?j:i,p=o-m;m=o,e&&(j+=d),g&&(i+=d),a.setDisposable(c.scheduleFuture(null,p,function(){if(g){var a=new s;k.push(a),b.onNext(t(a,h))}e&&k.shift().onCompleted(),f()}))}var g,h,i=d,j=a,k=[],l=new o,m=0;return g=new p(l),h=new r(g),k.push(new s),b.onNext(t(k[0],h)),f(),g.add(e.subscribe(function(a){for(var b=0,c=k.length;c>b;b++)k[b].onNext(a)},function(a){for(var c=0,d=k.length;d>c;c++)k[c].onError(a);b.onError(a)},function(){for(var a=0,c=k.length;c>a;a++)k[a].onCompleted();b.onCompleted()})),h},e)},j.windowWithTimeOrCount=function(a,b,c){var d=this;return w(c)||(c=m),new k(function(e){function f(b){var d=new n;g.setDisposable(d),d.setDisposable(c.scheduleFuture(null,a,function(){if(b===k){j=0;var a=++k;l.onCompleted(),l=new s,e.onNext(t(l,i)),f(a)}}))}var g=new o,h=new p(g),i=new r(h),j=0,k=0,l=new s;return e.onNext(t(l,i)),f(0),h.add(d.subscribe(function(a){var c=0,d=!1;l.onNext(a),++j===b&&(d=!0,j=0,c=++k,l.onCompleted(),l=new s,e.onNext(t(l,i))),d&&f(c)},function(a){l.onError(a),e.onError(a)},function(){l.onCompleted(),e.onCompleted()})),i},d)},j.bufferWithTime=function(a,b,c){return this.windowWithTime(a,b,c).flatMap(f)},j.bufferWithTimeOrCount=function(a,b,c){return this.windowWithTimeOrCount(a,b,c).flatMap(f)};var z=function(a){function b(b,c){this.source=b,this._s=c,a.call(this)}return g(b,a),b.prototype.subscribeCore=function(a){return this.source.subscribe(new A(a,this._s))},b}(l),A=function(a){function b(b,c){this._o=b,this._s=c,this._l=c.now(),a.call(this)}return g(b,a),b.prototype.next=function(a){var b=this._s.now(),c=b-this._l;this._l=b,this._o.onNext({value:a,interval:c})},b.prototype.error=function(a){this._o.onError(a)},b.prototype.completed=function(){this._o.onCompleted()},b}(h);j.timeInterval=function(a){return w(a)||(a=m),new z(this,a)};var B=function(a){function b(b,c,d,e,f,g){this._state=b,this._cndFn=c,this._itrFn=d,this._resFn=e,this._timeFn=f,this._s=g,a.call(this)}function c(a,b){if(a.hasResult&&a.o.onNext(a.result),a.first)a.first=!1;else if(a.newState=y(a.self._itrFn)(a.newState),a.newState===x)return a.o.onError(a.newState.e);if(a.hasResult=y(a.self._cndFn)(a.newState),a.hasResult===x)return a.o.onError(a.hasResult.e);if(a.hasResult){if(a.result=y(a.self._resFn)(a.newState),a.result===x)return a.o.onError(a.result.e);var c=y(a.self._timeFn)(a.newState);if(c===x)return a.o.onError(c.e);b(a,c)}else a.o.onCompleted()}return g(b,a),b.prototype.subscribeCore=function(a){var b={o:a,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(b,new Date(this._s.now()),c)},b}(l);i.generateWithAbsoluteTime=function(a,b,c,d,e,f){return w(f)||(f=m),new B(a,b,c,d,e,f)};var C=function(a){function b(b,c,d,e,f,g){this._state=b,this._cndFn=c,this._itrFn=d,this._resFn=e,this._timeFn=f,this._s=g,a.call(this)}function c(a,b){if(a.hasResult&&a.o.onNext(a.result),a.first)a.first=!1;else if(a.newState=y(a.self._itrFn)(a.newState),a.newState===x)return a.o.onError(a.newState.e);if(a.hasResult=y(a.self._cndFn)(a.newState),a.hasResult===x)return a.o.onError(a.hasResult.e);if(a.hasResult){if(a.result=y(a.self._resFn)(a.newState),a.result===x)return a.o.onError(a.result.e);var c=y(a.self._timeFn)(a.newState);if(c===x)return a.o.onError(c.e);b(a,c)}else a.o.onCompleted()}return g(b,a),b.prototype.subscribeCore=function(a){var b={o:a,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(b,0,c)},b}(l);i.generateWithRelativeTime=function(a,b,c,d,e,f){return w(f)||(f=m),new C(a,b,c,d,e,f)};var D=function(a){function b(b,c,d){this.source=b,this._dt=c,this._s=d,a.call(this)}function c(a,b){var c=b[0],d=b[1],e=b[2];e.setDisposable(c.subscribe(d))}return g(b,a),b.prototype.subscribeCore=function(a){var b=new o;return b.setDisposable(this._s.scheduleFuture([this.source,a,b],this._dt,c)),b},b}(l);j.delaySubscription=function(a,b){return w(b)||(b=m),new D(this,a,b)};var E=function(a){function b(b,c,d){this.source=b,this._d=c,this._s=d,a.call(this)}return g(b,a),b.prototype.subscribeCore=function(a){return this.source.subscribe(new F(a,this))},b}(l),F=function(a){function b(b,c){this._o=b,this._s=c._s,this._d=c._d,this._q=[],a.call(this)}return g(b,a),b.prototype.next=function(a){var b=this._s.now();for(this._q.push({interval:b,value:a});this._q.length>0&&b-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value)},b.prototype.error=function(a){this._o.onError(a)},b.prototype.completed=function(){for(var a=this._s.now();this._q.length>0&&a-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value);this._o.onCompleted()},b}(h);j.skipLastWithTime=function(a,b){return w(b)||(b=m),new E(this,a,b)};var G=function(a){function b(b,c,d){this.source=b,this._d=c,this._s=d,a.call(this)}return g(b,a),b.prototype.subscribeCore=function(a){return this.source.subscribe(new H(a,this._d,this._s))},b}(l),H=function(a){function b(b,c,d){this._o=b,this._d=c,this._s=d,this._q=[],a.call(this)}return g(b,a),b.prototype.next=function(a){var b=this._s.now();for(this._q.push({interval:b,value:a});this._q.length>0&&b-this._q[0].interval>=this._d;)this._q.shift()},b.prototype.error=function(a){this._o.onError(a)},b.prototype.completed=function(){for(var a=this._s.now();this._q.length>0;){var b=this._q.shift();a-b.interval<=this._d&&this._o.onNext(b.value)}this._o.onCompleted()},b}(h);j.takeLastWithTime=function(a,b){return w(b)||(b=m),new G(this,a,b)},j.takeLastBufferWithTime=function(a,b){var c=this;return w(b)||(b=m),new k(function(d){var e=[];return c.subscribe(function(c){var d=b.now();for(e.push({interval:d,value:c});e.length>0&&d-e[0].interval>=a;)e.shift()},function(a){d.onError(a)},function(){for(var c=b.now(),f=[];e.length>0;){var g=e.shift();c-g.interval<=a&&f.push(g.value)}d.onNext(f),d.onCompleted()})},c)};var I=function(a){function b(b,c,d){this.source=b,this._d=c,this._s=d,a.call(this)}function c(a,b){b.onCompleted()}return g(b,a),b.prototype.subscribeCore=function(a){return new q(this._s.scheduleFuture(a,this._d,c),this.source.subscribe(a))},b}(l);j.takeWithTime=function(a,b){return w(b)||(b=m),new I(this,a,b)};var J=function(a){function b(b,c,d){this.source=b,this._d=c,this._s=d,this._open=!1,a.call(this)}function c(a,b){b._open=!0}return g(b,a),b.prototype.subscribeCore=function(a){return new q(this._s.scheduleFuture(this,this._d,c),this.source.subscribe(new K(a,this)))},b}(l),K=function(a){function b(b,c){this._o=b,this._p=c,a.call(this)}return g(b,a),b.prototype.next=function(a){this._p._open&&this._o.onNext(a)},b.prototype.error=function(a){this._o.onError(a)},b.prototype.completed=function(){this._o.onCompleted()},b}(h);j.skipWithTime=function(a,b){return w(b)||(b=m),new J(this,a,b)};var L=function(a){function b(b,c,d){this.source=b,this._st=c,this._s=d,a.call(this)}function c(a,b){b._open=!0}return g(b,a),b.prototype.subscribeCore=function(a){return this._open=!1,new q(this._s.scheduleFuture(this,this._st,c),this.source.subscribe(new M(a,this)))},b}(l),M=function(a){function b(b,c){this._o=b,this._p=c,a.call(this)}return g(b,a),b.prototype.next=function(a){this._p._open&&this._o.onNext(a)},b.prototype.error=function(a){this._o.onError(a)},b.prototype.completed=function(){this._o.onCompleted()},b}(h);return j.skipUntilWithTime=function(a,b){return w(b)||(b=m),new L(this,a,b)},j.takeUntilWithTime=function(a,b){w(b)||(b=m);var c=this;return new k(function(d){return new q(b.scheduleFuture(d,a,function(a,b){b.onCompleted()}),c.subscribe(d))},c)},c});
//# sourceMappingURL=rx.lite.time.map